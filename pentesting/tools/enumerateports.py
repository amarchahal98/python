#!/usr/bin/python3

import os,sys,subprocess,re

host = (sys.argv[1])
os.system('clear')

cmd = "nmap -T4 -p- " + host + " > nmap-results.txt"
print("Running Command: " + cmd[:-18])
print("Storing results in \"nmap-results.txt\"")
os.system(cmd)
os.system("cat nmap-results.txt")

file = open("nmap-results.txt", "r")
ports = []
for line in file:
    if re.search("open", line):
        line = line.split('/')[0]
        ports.append(line)
        
ports = ",".join(ports)
print(ports)

enumportcmd = "nmap -T4 -A -p " + ports +" " + host
print(enumportcmd)
os.system(enumportcmd)

#ports = os.system("cat nmap-results.txt | grep open | cut -d'/' -f1")
